template_name: exclude
keywords:
  - "HÓA ĐƠN GIÁ TRỊ GIA TĂNG"
  - "chưa thuế"

options:
  decimal_separator: ','
  remove_thousand_separator: true
fields:
  invoice_number:
    parser: regex
    regex: 'Số \(No\.\):\s*(\d+)'

  date:
    parser: regex
    regex: 'Ngày \(date\) (\d{2} tháng \(month\) \d{2} năm \(year\) \d{4})'
    result_format: '{2}-{1}-{0}'  # yyyy-mm-dd

  seller:
    parser: regex
    regex: "Đơn vị bán hàng \\((?:Issued|Seller)\\):\\s*(.+)"
  seller_tax_code:
    regex: "Mã số thuế \\(Tax code\\):\\s*(\\d+)"
    parser: regex
    group: first

  seller_address:
    regex: "Địa chỉ \\(Address\\):\\s*(.+)"
    parser: regex
    group: first

  seller_phone:
    parser: regex
    regex: "Điện thoại \\((?:Phone number|Tel)\\):\\s*(.+?)(?=\\s*(Email|Số tài khoản))"
    group: first



  seller_bank_account:
    parser: regex
    regex: '(?s)Số tài khoản.*?:\s*(.*?)\s*Họ tên người mua hàng'


    

  #BUYER
  buyer_name:
    regex: "Họ tên người mua hàng \\(Buyer name\\):[ \\t\\r\\n]*?(?=Tên đơn vị \\(Company name|Company's name\\):)"
    parser: regex
    required: false
  buyer:
    parser: regex
    regex: "Tên đơn vị \\((Company name|Company's name)\\):\\s*(.+)"


  buyer_tax_id:
    regex: "Mã số thuế \\(Tax code\\):\\s*(\\d+)"
    parser: regex
    group: last

  buyer_address:
    regex: "Địa chỉ \\(Address\\):\\s*(.+)"
    parser: regex
    group: last


  payment_method: "Hình thức thanh toán \\(Payment method\\):\\s*([A-Z/]+)"

  buyer_bank_account:
    regex: "Số tài khoản \\(Account No\\.\\):\\s*(.+?)\\s*(?=Ghi chú \\(Note\\):)"
    parser: regex

  


  amount_untaxed:
    parser: regex
    regex: "Tổng\\s+tiền\\s+chịu\\s+thuế\\s+suất.*?:.*?\\d+%\\s+([\\d.]+)"

  amount_tax:
    parser: regex
    regex: 'Tiền thuế GTGT \(VAT Amount\):\s*([\d.,]+)'

  amount_total:
    parser: regex
    regex: "Tổng\\s+tiền\\s+chịu\\s+thuế\\s+suất.*?:.*?\\d+%\\s+[\\d.]+\\s+([\\d.]+)"
  amount:
    parser: regex
    regex: "Tổng\\s+tiền\\s+chịu\\s+thuế\\s+suất.*?:.*?\\d+%\\s+[\\d.]+\\s+[\\d.]+\\s+([\\d.]+)"

  

  lines:
    start: "Tên hàng hóa, dịch vụ"
    end: "Thuế suất"
    parser: lines
    merge_lines: false
    replace:
      - ["\\u00A0", " "]
    
    first_line:
      - "^\\s*(?P<item_no>\\d+)\\s{2,}(?P<name>.+?)\\s{2,}(?P<unit>\\S+)\\s{2,}(?P<quantity>[\\d.]+)\\s{2,}(?P<unit_price>[\\d.]+)\\s{2,}(?P<amount_before_vat>[\\d.]+)\\s{2,}(?P<vat_rate>\\d+%)\\s{2,}(?P<vat_amount>[\\d.]+)\\s{2,}(?P<amount_after_vat>[\\d.]+)"
    line: []








